–í–æ—Ç –∫—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ + —à–∞–≥–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏) –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã **Epoint** –Ω–∞ —Å–∞–π—Ç –∏–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

---
###  **Page 1-9**
### üìå **–¶–µ–ª—å**

–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∏–µ–º –æ–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É **Epoint**.

---

### üîß **–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å Epoint –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**

1. –ê–¥—Ä–µ—Å –í–∞—à–µ–≥–æ —Å–∞–π—Ç–∞
2. URL —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã ‚Äî `success_url`
3. URL –æ—à–∏–±–∫–∏ –æ–ø–ª–∞—Ç—ã ‚Äî `error_url`
4. URL –¥–ª—è –ø—Ä–∏—ë–º–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π ‚Äî `result_url`

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

* `public_key` ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (ID —Ç–æ—Ä–≥–æ–≤—Ü–∞)
* `private_key` ‚Äî —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä—ã

---

### üöÄ **–®–∞–≥–∏ —Ä–∞–±–æ—Ç—ã –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã Epoint**

1. **–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å API-–∑–∞–ø—Ä–æ—Å**:

   * –°–æ–∑–¥–∞—Ç—å `json` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–ª–∞—Ç–µ–∂–∞.
   * –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ `base64` ‚Üí —ç—Ç–æ `data`.
   * –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å `signature`:

     ```plaintext
     base64_encode( sha1( private_key + data + private_key, true ) )
     ```

2. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å POST-–∑–∞–ø—Ä–æ—Å** –Ω–∞:

   * `https://epoint.az/api/1/request` ‚Äî –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–ø–ª–∞—Ç—ã
     **–∏–ª–∏**
   * `https://epoint.az/api/1/checkout` ‚Äî –¥–ª—è –ø—Ä—è–º–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞

3. **–ö–ª–∏–µ–Ω—Ç –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–ø–ª–∞—Ç—ã –±–∞–Ω–∫–∞.

4. **–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã:**

   * –£–¥–∞—á–∞ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `success_url`
   * –û—à–∏–±–∫–∞ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `error_url`

5. **–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä—É –Ω–∞ `result_url` (POST-–∑–∞–ø—Ä–æ—Å —Å –¥–µ—Ç–∞–ª—è–º–∏ –ø–ª–∞—Ç–µ–∂–∞).

---

### üßæ **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `json` (–≤–Ω—É—Ç—Ä–∏ `data`)**

| –ü–∞—Ä–∞–º–µ—Ç—Ä               | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ                          |
| ---------------------- | ------------ | --------------------------------- |
| `public_key`           | ‚úÖ            | –í–∞—à ID –≤ —Å–∏—Å—Ç–µ–º–µ                  |
| `amount`               | ‚úÖ            | –°—É–º–º–∞ –æ–ø–ª–∞—Ç—ã                      |
| `currency`             | ‚úÖ            | –í–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `AZN`)          |
| `language`             | ‚úÖ            | –Ø–∑—ã–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`az`, `en`, `ru`)  |
| `order_id`             | ‚úÖ            | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–∫–∞–∑–∞              |
| `description`          | ‚≠ï            | –û–ø–∏—Å–∞–Ω–∏–µ (–¥–æ 1000 —Å–∏–º–≤–æ–ª–æ–≤)       |
| `is_installment`       | ‚≠ï            | 1 = —Ä–∞—Å—Å—Ä–æ—á–∫–∞, 0 = –æ–±—ã—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞ |
| `success_redirect_url` | ‚≠ï            | –°—Å—ã–ª–∫–∞ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ                 |
| `error_redirect_url`   | ‚≠ï            | –°—Å—ã–ª–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ                 |
| `other_attr`           | ‚≠ï            | –î–æ–ø. –ø–∞—Ä–∞–º–µ—Ç—Ä—ã                    |

---

### üì§ **–ò—Ç–æ–≥:**

–í—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ `data` –∏ `signature` –Ω–∞ —Å–µ—Ä–≤–µ—Ä Epoint. –í –æ—Ç–≤–µ—Ç ‚Äî `redirect_url`, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç. –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–ø–ª–∞—Ç—ã –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ `result_url`.

–•–æ—á–µ—à—å –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `data` –∏ `signature`?



-----------------------------------------------------------------------------------------------------------
###  **Page 9-14**
–í–æ—Ç –∫—Ä–∞—Ç–∫–æ–µ **–ø–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** –æ–±—Ä–∞–±–æ—Ç–∫–∏ callback-–∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –ø–ª–∞—Ç—ë–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ **Epoint** —Å –¥–µ—Ç–∞–ª—è–º–∏:

---

## **1. –ü–æ–ª—É—á–µ–Ω–∏–µ callback –æ—Ç Epoint**

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, **Epoint** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –≤–∞—à `result_url` HTTP **POST-–∑–∞–ø—Ä–æ—Å** —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

* `data` ‚Äî –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
* `signature` ‚Äî –ø–æ–¥–ø–∏—Å—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏

---

## **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞**

### –®–∞–≥ 1: –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ—é –ø–æ–¥–ø–∏—Å—å (signature)

–ù–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ:

1. –ü–æ–ª—É—á–∏—Ç–µ `data` –∏–∑ POST-–∑–∞–ø—Ä–æ—Å–∞.
2. –°—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É:
   `private_key + data + private_key`
3. –í—ã—á–∏—Å–ª–∏—Ç–µ SHA1 –æ—Ç —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ (–≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ).
4. –ó–∞–∫–æ–¥–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ base64.

–í–æ—Ç C# –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `signature` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç Epoint:

```csharp
using System;
using System.Security.Cryptography;
using System.Text;

public class EpointSignatureHelper
{
    public static string GenerateSignature(string privateKey, string data)
    {
        // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É: private_key + data + private_key
        string sgnString = privateKey + data + privateKey;

        // SHA1-—Ö–µ—à –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ
        using (SHA1 sha1 = SHA1.Create())
        {
            byte[] hashBytes = sha1.ComputeHash(Encoding.UTF8.GetBytes(sgnString));

            // –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Ö–µ—à –≤ base64
            return Convert.ToBase64String(hashBytes);
        }
    }
}
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```csharp
string privateKey = "your_private_key";
string data = "–ø–æ–ª—É—á–µ–Ω–Ω–æ–µ_–∑–Ω–∞—á–µ–Ω–∏–µ_data";

string signature = EpointSignatureHelper.GenerateSignature(privateKey, data);

// –°—Ä–∞–≤–Ω–∏–≤–∞–µ—à—å —ç—Ç—É –ø–æ–¥–ø–∏—Å—å —Å –ø—Ä–∏—à–µ–¥—à–µ–π –æ—Ç Epoint
bool isValid = (signature == signatureFromEpoint);
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É —Ç–∞–∫–∂–µ –ø–æ–º–æ—á—å —Å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º `data` –∏–∑ base64 –∏ –ø–∞—Ä—Å–∏–Ω–≥–æ–º JSON.

–û—Ç–ª–∏—á–Ω–æ, –≤–æ—Ç –∫–∞–∫ –≤ C#:

---

## ‚úÖ –†–∞—Å–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å `data` –∏–∑ base64 –∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON

```csharp
using System;
using System.Text;
using System.Text.Json;

public class EpointDataHelper
{
    public static JsonDocument DecodeData(string base64Data)
    {
        // –î–µ–∫–æ–¥–∏—Ä—É–µ–º –∏–∑ base64
        byte[] dataBytes = Convert.FromBase64String(base64Data);
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å—Ç—Ä–æ–∫—É (UTF-8)
        string jsonString = Encoding.UTF8.GetString(dataBytes);
        
        // –†–∞–∑–±–∏—Ä–∞–µ–º JSON
        return JsonDocument.Parse(jsonString);
    }
}
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```csharp
string base64Data = "–ø–æ–ª—É—á–µ–Ω–Ω–æ–µ_–∑–Ω–∞—á–µ–Ω–∏–µ_data_–∏–∑_callback";

var jsonDoc = EpointDataHelper.DecodeData(base64Data);
var root = jsonDoc.RootElement;

// –ü—Ä–∏–º–µ—Ä—ã –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º:
string orderId = root.GetProperty("order_id").GetString();
string status = root.GetProperty("status").GetString();
string message = root.GetProperty("message").GetString();
decimal amount = root.GetProperty("amount").GetDecimal();

Console.WriteLine($"Order ID: {orderId}, Status: {status}, Amount: {amount}, Message: {message}");
```

---

## ‚ö†Ô∏è –£–±–µ–¥–∏—Å—å:

* –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `System.Text.Json` –¥–æ—Å—Ç—É–ø–Ω–∞ —Å .NET Core 3.0+ –∏–ª–∏ .NET 5+
* –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Å—Ç–∞—Ä—ã–π .NET Framework, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Newtonsoft.Json`

–•–æ—á–µ—à—å –ø—Ä–∏–º–µ—Ä –Ω–∞ `Newtonsoft.Json` —Ç–æ–∂–µ?


### –®–∞–≥ 2: –°—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∏

* –°—Ä–∞–≤–Ω–∏—Ç–µ –≤–∞—à—É `signature` —Å —Ç–æ–π, —á—Ç–æ –ø—Ä–∏—à–ª–∞ –æ—Ç **Epoint**
* –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Üí –∑–∞–ø—Ä–æ—Å –ø–æ–¥–ª–∏–Ω–Ω—ã–π

---

## **3. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `data`**

* –†–∞—Å–∫–æ–¥–∏—Ä—É–π—Ç–µ `data` –∏–∑ base64 ‚Üí –ø–æ–ª—É—á–∏—Ç—Å—è JSON-—Å—Ç—Ä–æ–∫–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

---

## **4. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**

–ü—Ä–∏–º–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ—Å–ª–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è `data`:

```json
{
  "order_id": "12345",
  "status": "success",
  "code": "00",
  "message": "–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ",
  "transaction": "...",
  "bank_transaction": "...",
  "operation_code": "100",
  "rrn": "123456789012",
  "card_name": "Ivan Ivanov",
  "card_mask": "123456******1234",
  "amount": 100.00,
  "other_attr": { ... }
}
```

* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `status`, `code`, `message` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
* –ü—Ä–∏–º–µ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤:

  * `new` ‚Äî –ø–ª–∞—Ç—ë–∂ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
  * `success` ‚Äî –ø–ª–∞—Ç—ë–∂ —É—Å–ø–µ—à–µ–Ω
  * `error`, `server_error` ‚Äî –æ—à–∏–±–∫–∞
  * `returned` ‚Äî –≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤

---

## **5. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –∑–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –≤—Ä—É—á–Ω—É—é**

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ **—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, –≤—ã–∑–æ–≤–∏—Ç–µ API Epoint:

* URL: `https://epoint.az/api/1/get-status`
* –ú–µ—Ç–æ–¥: POST
* –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

  * `data` ‚Äî base64(json)
  * `signature` ‚Äî –∫–∞–∫ –∏ —Ä–∞–Ω–µ–µ

---

## **–ò—Ç–æ–≥**

–°—Ü–µ–Ω–∞—Ä–∏–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

1. –ü–æ–ª—É—á–∏–ª–∏ `POST` –æ—Ç Epoint ‚Üí –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ `signature`
2. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–ª–∏ `data` ‚Üí –ø–æ–ª—É—á–∏–ª–∏ —Å—Ç–∞—Ç—É—Å –∏ –¥–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞
3. –°–æ—Ö—Ä–∞–Ω–∏–ª–∏/–æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Å–∏—Å—Ç–µ–º–µ
4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–¥–µ–ª–∞–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ `get-status` –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è


---------------------------------------------------------------------------------------------------------
###  **Page 14-19**

–í–æ—Ç –∫—Ä–∞—Ç–∫–æ–µ **–ø–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π **Epoint** –¥–ª—è **—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã** –∏ **–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–∞—Ä—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ **–±—ç–∫–µ–Ω–¥–µ C#**:

---

## ‚úÖ **1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã)**

### **–¶–µ–ª—å:**

–ü–æ–ª—É—á–∏—Ç—å `card_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞—Ä—Ç—ã, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π.

### **–®–∞–≥–∏:**

1. **–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å JSON-–æ–±—ä–µ–∫—Ç** —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

   * `public_key` ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Ç–æ—Ä–≥–æ–≤—Ü–∞.
   * `language` ‚Äî —è–∑—ã–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: az, en, ru.
   * `refund` ‚Äî (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) 0 –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è, 1 –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã.
   * `description` ‚Äî (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –æ–ø–∏—Å–∞–Ω–∏–µ.
   * `success_redirect_url` –∏ `error_redirect_url` ‚Äî (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.

2. **–ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å JSON –∫–∞–∫ —Å—Ç—Ä–æ–∫—É (`data`)**, –∑–∞—Ç–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `signature`:

   ```csharp
   string signature = HmacSHA256(data, privateKey);
   ```

3. **POST-–∑–∞–ø—Ä–æ—Å** –Ω–∞ `https://epoint.az/api/1/card-registration` —Å `data` –∏ `signature`.

4. **–û—Ç–≤–µ—Ç Epoint:**

   * `status` = "success" –∏–ª–∏ "error".
   * `redirect_url` ‚Äî –∞–¥—Ä–µ—Å, –∫—É–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –≤–≤–æ–¥–∞ –∫–∞—Ä—Ç—ã.
   * `card_id` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ (–∫–ª—é—á –¥–ª—è –æ–ø–ª–∞—Ç—ã –≤ –±—É–¥—É—â–µ–º).

---

## ‚úÖ **2. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã (callback –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä)**

### **–°—Ü–µ–Ω–∞—Ä–∏–π:**

–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã Epoint –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –Ω–∞ –≤–∞—à `result_url`.

### **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

* `data` (–∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ JSON)
* `signature`

### **–ù–∞ –≤–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `signature`, –ø–µ—Ä–µ—Å—á–∏—Ç–∞–≤ HMAC —Å `data` –∏ `private_key`.

2. –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å —Å–æ–≤–ø–∞–¥–∞–µ—Ç:

   * –†–∞—Å–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å `data`, –∏–∑–≤–ª–µ—á—å:

     * `status`, `code`, `message`
     * `card_id`, `card_mask`, `card_name`, `operation_code`
     * `bank_transaction`, `bank_response`, `rrn`

3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `card_id` ‚Äî –æ–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è.

---

## ‚úÖ **3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ–π**

### **–¶–µ–ª—å:**

–ü—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ–ø–ª–∞—Ç—É –±–µ–∑ –≤–≤–æ–¥–∞ –∫–∞—Ä—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—è `card_id`.

### **–®–∞–≥–∏:**

1. **–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å JSON-–æ–±—ä–µ–∫—Ç** —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

   * `public_key`
   * `language`
   * `card_id` ‚Äî –ø–æ–ª—É—á–µ–Ω —Ä–∞–Ω–µ–µ.
   * `order_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ.
   * `amount`, `currency` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100, "AZN")
   * `description` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

2. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `data` –∏ `signature`**, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —à–∞–≥—É 1.

3. **POST-–∑–∞–ø—Ä–æ—Å** –Ω–∞ `https://epoint.az/api/1/execute-pay`.

4. **–û—Ç–≤–µ—Ç –æ—Ç Epoint:**

   * `status` = "success" –∏–ª–∏ "failed"
   * `transaction`, `bank_transaction`, `rrn`, `bank_response`
   * `card_name`, `card_mask`, `amount`
   * `message`

---

## ‚öôÔ∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

* `signature = HMAC_SHA256(data, private_key)` ‚Äî —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–∞ —Å—Ç—Ä–æ–≥–æ —ç—Ç–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º.
* `data` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π JSON –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏.
* –ò—Å–ø–æ–ª—å–∑—É–π `System.Text.Json` –∏–ª–∏ `Newtonsoft.Json` –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
* –ò—Å–ø–æ–ª—å–∑—É–π `System.Security.Cryptography.HMACSHA256` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏.

---

---------------------------------------------------------------------------------------------------------------------------
###  **Page 19-24**

–í–æ—Ç –∫—Ä–∞—Ç–∫–æ–µ **–ø–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** –¥–ª—è **—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–ø–ª–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ–π** —á–µ—Ä–µ–∑ **Epoint API**.

---

## ‚úÖ **1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π)**

### –®–∞–≥ 1: –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å `data` –∏ `signature`

* **URL –∑–∞–ø—Ä–æ—Å–∞**: `https://epoint.az/api/1/card-registration`
* **–ú–µ—Ç–æ–¥**: POST

### –§–æ—Ä–º–∞—Ç JSON (`json_string`):

```json
{
  "public_key": "i000000001",
  "language": "ru",
  "refund": 0,
  "description": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã",
  "success_redirect_url": "https://yourapp.com/success",
  "error_redirect_url": "https://yourapp.com/error"
}
```

### –®–∞–≥ 2: –ü–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞

```csharp
string sgnString = privateKey + data + privateKey;
byte[] hashBytes = SHA1.Create().ComputeHash(Encoding.UTF8.GetBytes(sgnString));
string signature = Convert.ToBase64String(hashBytes);
```

### –®–∞–≥ 3: –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞

#### –û—Ç–≤–µ—Ç:

```json
{
  "status": "success",
  "redirect_url": "https://secure.epoint.az/form/...",
  "card_id": "xxxxxxxxxxxx"
}
```

‚û°Ô∏è **–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ `redirect_url`**, —á—Ç–æ–±—ã –æ–Ω –≤–≤—ë–ª –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –∏ –ø—Ä–æ—à—ë–ª 3DS –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

---

## ‚úÖ **2. –ü–æ–ª—É—á–µ–Ω–∏–µ callback –æ—Ç Epoint**

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ `success_redirect_url` –∏–ª–∏ `error_redirect_url`. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∏—Ç **POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `result_url`** –æ—Ç Epoint —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

* `data` (base64)
* `signature`

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–ø–∏—Å—å —Ç–∞–∫ –∂–µ, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø—Ä–∏–º–µ—Ä–µ:

```csharp
// server-side
bool isValid = (signature == EpointSignatureHelper.GenerateSignature(privateKey, data));
```

### –†–∞—Å—à–∏—Ñ—Ä—É–π—Ç–µ `data` –∏ –ø–æ–ª—É—á–∏—Ç–µ `card_id`:

```json
{
  "status": "success",
  "card_id": "xxxxxxxxxxxx",
  ...
}
```

---

## ‚úÖ **3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ–π**

### –®–∞–≥ 1: –°—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ `json_string`

```json
{
  "public_key": "i000000001",
  "language": "ru",
  "card_id": "xxxxxxxxxxxx",         // –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞
  "order_id": "order-12345",
  "amount": 100.00,
  "currency": "AZN",
  "description": "–û–ø–ª–∞—Ç–∞ —Ç–æ–≤–∞—Ä–∞"
}
```

### –®–∞–≥ 2: –ü–æ–¥–ø–∏—Å—å (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ):

```csharp
string data = Convert.ToBase64String(Encoding.UTF8.GetBytes(jsonString));
string signature = GenerateSignature(privateKey, data);
```

### –®–∞–≥ 3: –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞:

* `https://epoint.az/api/1/execute-pay`
* POST `{ data, signature }`

---

## ‚úÖ **4. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç Epoint (execute-pay)**

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
{
  "status": "success",
  "transaction": "tx123456",
  "bank_transaction": "...",
  "bank_response": "...",
  "rrn": "987654321098",
  "card_name": "Ivan Ivanov",
  "card_mask": "411111******1111",
  "amount": 100.00,
  "message": "–û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞"
}
```

---

## ‚úÖ **–ò—Ç–æ–≥–∏ (–±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞):**

| –®–∞–≥ | –î–µ–π—Å—Ç–≤–∏–µ                                | –¶–µ–ª—å                                       |
| --- | --------------------------------------- | ------------------------------------------ |
| 1   | –í—ã–∑–æ–≤ `/card-registration`              | –ü–æ–ª—É—á–∏—Ç—å `card_id`                         |
| 2   | –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `redirect_url`       | –ö–ª–∏–µ–Ω—Ç –≤–≤–æ–¥–∏—Ç –∫–∞—Ä—Ç—É                        |
| 3   | –ü–æ–ª—É—á–µ–Ω–∏–µ callback (`result_url`)       | –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å `card_id` |
| 4   | –í—ã–∑–æ–≤ `/execute-pay` —Å `card_id`        | –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–ª–∞—Ç—ë–∂ –±–µ–∑ –≤–≤–æ–¥–∞ –∫–∞—Ä—Ç—ã           |
| 5   | –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É | –§–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç—ë–∂                      |

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å C#-–∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∏—Ö —à–∞–≥–æ–≤.
